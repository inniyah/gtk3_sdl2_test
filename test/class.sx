class k
	name = 'kclass'
	function init (value)
		global init = 16
	end
	function setvar (value)
		self.var = value
	end
end
k.test = function ()
	return name
end

g = new k

if k.test () != 'kclass' then
	printl ('k.test() failure')
	return 1
end

k.setvar ('hey')
if k.var != 'hey' or g.var != 'hey' then
	printl ('*.var failure')
	return 1
end

g.setvar ('hmm')
if k.var != 'hey' or g.var != 'hmm' then
	printl ('*.var failure 2')
	return 1
end

if g.name != 'kclass' then
	printl ('g.name failure')
	return 1
end

g.name = 'g'

if g.name != 'g' or k.name != 'kclass' then
	printl ('*.name failure')
	return 1
end

if ! g isa k or k isa g then
	return 1
end

if init != 16 then
	printl ('init failure: ', init)
	return 1
end

printl ('all good')

return 0
